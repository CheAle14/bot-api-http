<!DOCTYPE html>
<head>
    <title>Chess Tournament Leaderboard</title>
    <link rel="stylesheet" type="text/css" href="/css">
    <style>
        #admin {
            border: red 1px;
            margin: 1px;
            background-color: lightcoral;
        }
        .header {
            font-size: x-large;
            font-weight: bold;
            float: left;
        }
        div p {
            width: 100%;
            height: 100%;
            margin-top: 0;
            text-align: center;
        }
        .full_popup {
            position:fixed;
            padding: 0 0 0 1%;
            margin:0;
            top:0;
            left:0;
            background: white;

            width: 100%;
            height: 100%;}
        .taste_the_gay {
            background: rgb(255,0,0);
            background: linear-gradient(180deg, rgba(255,0,0,1) 0%, rgba(255,157,0,1) 20%, rgba(241,255,0,1) 40%, rgba(0,138,27,1) 60%, rgba(7,0,255,1) 80%, rgba(123,0,255,1) 100%);
        }
        @media screen and (min-width: 0px){
            .full_popup {
                font-size: 400%;
            }
        }
        @media (min-width: 150px) {
            .full_popup {
                font-size: 300%;
            }
        }
        @media (min-width: 300px) {
            .full_popup {
                font-size: 200%;
            }
        }
        @media (min-width:600px) {
            .full_popup {
                font-size: 150%;
            }
        }
        .full_popup p {
            width: 100%;
            height: 25px;
            text-align: left;
        }
        .full_popup h1,
        .full_popup h2,
        .full_popup a {
            text-align: center;
        }
    </style>
</head>
<body>
    <div id='popupmod' class='taste_the_gay'>
        <h1>Tournament Moderators</h1>
        <p>The following people are considered Tournament Moderators:</p>
        <ul>
            <li>Akshaya A.</li>
            <li>Mrs Doran</li>
            <li>Reece B.</li>
            <li>Troy S.</li>
        </ul>
        <p>These individuals have the power to:</p>
        <ul>
            <li>Under Section I, Act 2 - Penalise any Member for unsportsmanlike conduct, or cheating</li>
            <li>Under Section I, Act 5 - Forcefully end any game through capture-points if beyond time limit</li>
            <li>Under Section I, Act 6 - Preside over rematches that are played</li>
            <li>Under Section I, Act 7 - Be present during any game that involves a Chessclock</li>
            <li>Under Section II, Act 3 - Make changes to any Members score, rating, or ranking</li>
            <li>Under Section II, Act 5 - Penalise any Member for fraudulently adding games</li>
            <li>Under Section II, Act 7 - Ban Member's from the Leaderboard for serious misconduct</li>
            <li>Under Section II, Act 8 - Set any Member to be monitored, requiring their games be approved</li>
            <li>Under Section III, Act 2.2 - Broad authority to ensure the integrity of the Leaderboard</li>
        </ul>
        <br/>
        <p>Also note that pursuant to Section III, Act 3.3, Justices of the Court of Appeal may excercise the powers listed above.</p>
        <a href="#" onclick="setHideCookie(this);">Click here to close, once majority have read</a>
        <p>Not sure if anyone even reads this so hi random person</p>
    </div>
    <div style="height: 35px;display: grid;grid-auto-flow: column;grid-template-columns: 25% 50% 25%;">
        <label class="header">Chess Leaderboard</label>
        <REPLACE id='admin'/>
        <REPLACE id='loginBtn'/>
    </div>
    <div id="popup1" style="background: lightsalmon; width:100%; height:50px; border: 2px black solid; padding: 2px;">
        <p><strong><a href="/chess/terms">Chess Terms and Conditions are now in affect</a></strong>
            <br><a href="#" onclick="setHideCookie(this);">Click here to close</a>
        </p>
    </div>
    <div id="popup2" style="margin-top:10px; background: lightgreen; width:100%; height:50px; border: 2px black solid; margin-bottom: 10px;">
        <p><strong><a href="/chess/coa">Chess Court of Appeals is now open to hear any issues</a></strong>
            <br><a href="#" onclick="setHideCookie(this);">Click here to close</a>
        </p>
    </div>
    <div id="popup3" style="margin-top:10px; background: rgb(0, 225, 255); width:100%; height:50px; border: 2px black solid; margin-bottom: 10px;">
        <p><strong><a href="/chess/clock">A Chess Clock is available for use on a horizontal phone screen</a></strong>
            <br><a href="#" onclick="setHideCookie(this);">Click here to close</a>
        </p>
    </div>
    <div id="popuplogin" style="margin-top:10px; background: rgb(183, 0, 255); width:100%; height:125px; border: 2px black solid; margin-bottom: 10px;">
        <p><strong>It is possible to <a href='/login'>login</a> using the following account details:</strong>
            <br/>Name - <em>ClassRoom</em>
            <br/>Password - <em>fridaylunchtime</em>
            <br/>It is unneeded to specific the Id.
            <br/>This account may add games only during Friday
            <br><a href="#" onclick="setHideCookie(this);">Click here to close</a>
        </br/>
    </div>
    <REPLACE id='discord_link'/>
    <table>
        <tr><th>Position</th><th>Score</th><th>Name</th><th>W/L %</th><th>W/L Raw</th></tr>
        <REPLACE id="table"/>
    </table>
    <hr style="margin-top: 15px;">
    <ul>
        <li><a href='/chess/terms'>Chess Terms and Conditions</a></li>
        <li><a href='/chess/register'>Take the Register</a></li>
        <li><a href='/chess/coa'>Chess Court of Appeals - Appeal a punishment, technical modification or something else</a></li>
        <li><a href='/chess/clock?seconds=300'>Chess Clock - 5 minutes each player</a>
            <ul>
                <li><a href='/chess/clock?seconds=420'>Chess Clock - 7 minutes each player</a></li>
                <li><a href='/chess/clock?seconds=600'>Chess Clock - 10 minutes each player</a></li>
            </ul>
        </li>
        <li><a href='/chess/clock?seconds=300&black=360'>Chess Clock - 5 minutes white, 6 minutes black</a>
            <ul>
                <li><a href='/chess/clock?seconds=420&black=540'>Chess Clock - 7 minutes white, 9 minutes black</a></li>
                <li><a href='/chess/clock?seconds=600&black=720'>Chess Clock - 10 minutes white, 12 minutes black</a></li>
            </ul>
        </li>
    </ul>

    <script>
        function newuser() {
            var name = prompt("Enter new person's name");
            if(name == null || name == "") {
                // cancelled
            } else {
                fetch("/chess/api/player?name=" + name, 
                    {"method": "PUT"}
                )
                .then(function (response) {
                    if(response.ok) {
                        setTimeout(function reload() {
                            window.location.replace(window.location);
                        }, 1000);
                    } else {
                        response.text().then(function r(t) {alert(t);});
                    }
                })
                .catch(function(r){alert(r);});
            }
        }

        function doMarkPresent(id) {
                fetch("/chess/api/present?id=" + id, 
                    {"method": "PUT"}
                )
                .then(function (response) {
                    if(response.ok) {
                        setTimeout(function reload() {
                            window.location.replace(window.location);
                        }, 1000);
                    } else {
                        response.text().then(function r(t) {alert(t);});
                    }
                })
                .catch(function(r){alert(r);});
        }

        function matchend() {
            window.location.replace("/chess/match");
        }

        function moduser() {
            window.location.replace("/chess/userlist");
        }

        function setCookie(cname, cvalue, exdays) {
            var d = new Date();
            d.setTime(d.getTime() + (exdays*24*60*60*1000));
            var expires = "expires="+ d.toUTCString();
            document.cookie = cname + "=" + cvalue + ";" + expires + ";path=/";
        }

        function setHideCookie(element) {
            var div = element.closest("body > div");
            if(!div)
                return;
            div.style.display = "none";
            setCookie(div.id.replace("popup", ""), "hide-popup", 180);
        }

        function getCookie(cname) {
            var name = cname + "=";
            var decodedCookie = decodeURIComponent(document.cookie);
            var ca = decodedCookie.split(';');
            for(var i = 0; i <ca.length; i++) {
                var c = ca[i];
                while (c.charAt(0) == ' ') {
                c = c.substring(1);
                }
                if (c.indexOf(name) == 0) {
                return c.substring(name.length, c.length);
                }
            }
            return "";
        }

        function hideOtherPopups() {
            var x = document.cookie.split(";");
            console.log(x);
            for(var i = 0; i < x.length; i++) {
                var full = x[i];
                var start = 0;
                if(full[0] === " ")
                    start = 1;
                var name = full.substring(start, full.indexOf("="));
                var value = getCookie(name);
                console.log(name)
                console.log(value)
                if(value === "hide-popup") {
                    var thing = document.getElementById("popup" + name);
                    if(thing) {
                        thing.style.display = "none";
                    }
                }
            }
        }
        hideOtherPopups();
    </script>
</body>