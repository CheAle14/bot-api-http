<!DOCTYPE html>
<html>
    <head>
        <title>Recipes</title>
    </head>
    <body>
        <a href="/food/add-recipe">Add Recipe</a>
        <REPLACE id="ongoing"/>
        <REPLACE id="table"/>

        <input type="button" value="Start selected" onclick="startRecipe()">

        <script>
            function startRecipe() {

                var selected = [];
                var selects = document.getElementsByClassName("recipe-selects");
                console.log(selects);
                for(let x of selects) {
                    console.log(x);
                    if(x.checked) {
                        selected.push(x.id);
                    }
                }

                fetch(`/api/food/recipes`, {
                    method: 'PUT',
                    body: JSON.stringify(selected)
                }).then(function(resp) {
                    console.log(resp);
                    if(resp.ok) {
                        resp.text().then(function(t) {
                            window.location = `/food/ongoing-recipe?id=${t}`;
                        })
                    }
                }).catch(function(err) {
                    console.log(err);
                })
            }
            function deleteRecipe(id) {
                var x = prompt("Are you sure you want to delete this? Type yes to continue", "")
                if(x !== "yes")
                    return;
                fetch(`/api/food/recipe?id=${id}`, {method: "DELETE"}).then(function(resp) {
                    console.log(resp);
                    if(resp.ok) {
                        window.location.reload();
                    } else {
                        console.error(resp);
                    }
                }).catch(function(err) {
                    console.error(err);
                })
            }
        </script>
    </body>
</html>